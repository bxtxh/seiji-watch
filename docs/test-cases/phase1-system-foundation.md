# Phase 1: システム基盤検証テストケース
**期間**: 2日間  
**参加者**: 管理者テスター + 政治専門家  
**目的**: システムの基盤機能と認証・API・データベース連携の検証

---

## 🔐 認証システムテスト

### T1.1 JWT認証フロー
**担当**: 管理者テスター  
**優先度**: Critical

#### テストケース
- [ ] **T1.1.1**: 正常ログイン（有効なメール・トークン）
  - **手順**: 
    1. テストアカウントでログインページアクセス
    2. 提供されたメール・JWTトークンで認証
    3. ダッシュボードへリダイレクト確認
  - **期待結果**: 認証成功、ユーザー情報表示、適切な権限設定
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

- [ ] **T1.1.2**: 無効なトークンでのアクセス拒否
  - **手順**:
    1. 無効なJWTトークンでAPI呼び出し
    2. 期限切れトークンでアクセス試行
    3. 改ざんされたトークンでアクセス試行
  - **期待結果**: 401 Unauthorized、適切なエラーメッセージ
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

- [ ] **T1.1.3**: 権限別アクセス制御
  - **手順**:
    1. 一般ユーザーアカウントで管理者エンドポイントアクセス
    2. 専門家アカウントで権限外データアクセス
    3. 各ロールの適切な権限確認
  - **期待結果**: 403 Forbidden、権限に応じた適切なアクセス制御
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

### T1.2 Google OAuth統合
**担当**: 管理者テスター  
**優先度**: High

#### テストケース
- [ ] **T1.2.1**: Google OAuth ログインフロー
  - **手順**:
    1. "Googleでログイン"ボタンクリック
    2. Google認証画面での認証完了
    3. アプリケーションへのコールバック確認
  - **期待結果**: OAuth認証成功、JWT発行、ユーザープロファイル取得
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

---

## 🌐 API Gatewayテスト

### T1.3 API エンドポイント基本動作
**担当**: 管理者テスター + 政治専門家  
**優先度**: Critical

#### 主要エンドポイント
- [ ] **T1.3.1**: `/api/health` - ヘルスチェック
  - **期待結果**: 200 OK、サービス状態情報
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

- [ ] **T1.3.2**: `/api/bills` - 法案一覧取得
  - **期待結果**: 200 OK、第217回国会法案リスト
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

- [ ] **T1.3.3**: `/api/bills/{id}` - 法案詳細取得
  - **期待結果**: 200 OK、法案詳細情報（概要・背景・効果・審議状況）
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

- [ ] **T1.3.4**: `/api/members` - 議員一覧取得
  - **期待結果**: 200 OK、衆参両院議員データ
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

- [ ] **T1.3.5**: `/api/issues/categories` - 政策カテゴリ取得
  - **期待結果**: 200 OK、CAP 3層分類データ
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

### T1.4 API レート制限・CORS
**担当**: 管理者テスター  
**優先度**: High

#### テストケース
- [ ] **T1.4.1**: レート制限機能
  - **手順**:
    1. 未認証ユーザーで5 req/s超過リクエスト送信
    2. 認証ユーザーでレート制限テスト
    3. 制限解除時間の確認
  - **期待結果**: 429 Too Many Requests、適切な制限とリセット
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

- [ ] **T1.4.2**: CORS設定確認
  - **手順**:
    1. 許可ドメインからのプリフライトリクエスト
    2. 未許可ドメインからのアクセス試行
    3. 必要なCORSヘッダー確認
  - **期待結果**: 適切なCORSヘッダー、許可/拒否制御
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

---

## 🔗 マイクロサービス連携テスト

### T1.5 サービス間通信
**担当**: 管理者テスター  
**優先度**: Critical

#### テストケース
- [ ] **T1.5.1**: API Gateway ⟷ Ingest Worker データフロー
  - **手順**:
    1. API経由での新規データ取得リクエスト
    2. Ingest Workerでのスクレイピング実行
    3. 処理結果のAPI Gatewayへの反映確認
  - **期待結果**: 非同期処理完了、データ更新通知、エラーハンドリング
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

- [ ] **T1.5.2**: Vector Store連携
  - **手順**:
    1. 議事録テキストの埋め込み生成リクエスト
    2. セマンティック検索実行
    3. 類似度スコア・結果順位確認
  - **期待結果**: 適切な埋め込み生成、検索精度、レスポンス時間
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

---

## 🗄️ データベーステスト

### T1.6 PostgreSQL基本動作
**担当**: 管理者テスター  
**優先度**: Critical

#### テストケース
- [ ] **T1.6.1**: 基本CRUD操作
  - **手順**:
    1. テストデータのCreate（法案・議員・委員会）
    2. 条件付きRead（フィルタ・ソート・ページング）
    3. データUpdate（ステータス変更・情報修正）
    4. データDelete（論理削除・物理削除）
  - **期待結果**: 全CRUD操作正常実行、トランザクション整合性
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

- [ ] **T1.6.2**: 複雑クエリ・結合処理
  - **手順**:
    1. 法案×議員×委員会の3テーブル結合クエリ
    2. 集計処理（政党別法案数・委員会別審議時間）
    3. 全文検索（議事録テキスト検索）
  - **期待結果**: クエリ実行時間<1秒、正確な結果セット
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

### T1.7 バックアップ・復旧
**担当**: 管理者テスター  
**優先度**: High

#### テストケース
- [ ] **T1.7.1**: 自動バックアップ機能
  - **手順**:
    1. バックアップスケジュール確認
    2. バックアップファイル生成確認
    3. バックアップ整合性チェック
  - **期待結果**: 定期バックアップ実行、完全性検証OK
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

- [ ] **T1.7.2**: 災害復旧テスト
  - **手順**:
    1. テストデータベース作成・データ投入
    2. 意図的な障害シミュレーション
    3. バックアップからの復旧実行
    4. データ整合性・機能動作確認
  - **期待結果**: RPO<1時間、RTO<30分、データ損失なし
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

---

## 🔌 外部サービス連携テスト

### T1.8 Airtable統合
**担当**: 政治専門家 + 管理者テスター  
**優先度**: High

#### テストケース
- [ ] **T1.8.1**: データ同期機能
  - **手順**:
    1. 新規法案データのAirtable書き込み
    2. Airtableでの手動更新
    3. システムへの変更反映確認
  - **期待結果**: 双方向同期、データ整合性、コンフリクト解決
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

### T1.9 Weaviate Vector Store
**担当**: 管理者テスター  
**優先度**: High

#### テストケース
- [ ] **T1.9.1**: 埋め込み生成・検索
  - **手順**:
    1. 日本語テキストの埋め込み生成
    2. ベクトル類似度検索実行
    3. セマンティック検索精度確認
  - **期待結果**: 適切な埋め込み生成、検索精度>80%
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

### T1.10 Cloud Storage統合
**担当**: 管理者テスター  
**優先度**: Medium

#### テストケース
- [ ] **T1.10.1**: ファイルアップロード・ダウンロード
  - **手順**:
    1. 議事録PDF・音声ファイルアップロード
    2. ファイル一覧取得・メタデータ確認
    3. ダウンロードリンク生成・アクセス確認
  - **期待結果**: 大容量ファイル対応、セキュアアクセス
  - **実際結果**: [ ]
  - **Status**: [ ] PASS [ ] FAIL

---

## 📊 Phase 1 成功基準

### 定量基準
- [ ] **API成功率**: >99%（全エンドポイント）
- [ ] **認証成功率**: 100%（正常ケース）
- [ ] **データベース応答時間**: <500ms（基本クエリ）
- [ ] **外部サービス連携**: エラー率<1%

### 定性基準
- [ ] 政治専門家による「データアクセス・操作性」承認
- [ ] 管理者による「運用・監視・障害対応」可能性確認
- [ ] システムログ・エラーハンドリングの適切性確認

### 問題レポート
**Critical問題**: [ ] 件  
**High問題**: [ ] 件  
**Medium問題**: [ ] 件  
**Low問題**: [ ] 件

### Phase 1完了判定
- [ ] 全Critical問題解決済み
- [ ] High問題<3件（対応計画有り）
- [ ] 基盤システム安定稼働確認
- [ ] Phase 2（データ品質検証）開始可能

---

**テスト実施日**: [ ]  
**テスト完了日**: [ ]  
**レビュー担当**: [ ]  
**承認**: [ ] Phase 2進行可 [ ] 追加修正必要